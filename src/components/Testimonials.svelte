<script lang="ts">
  export let title: string = "Testimonials";

  const testimonials = [
    {
      name: "Andrew Cheong",
      date: "November 2025",
      quote:
        "Massive thanks to TMS BIKE Towing team. They are kind, reliable, and help us wholeheartedly during the worst flooding in Hatyai! Thanks for helping us through each and every critical moment. Because of them, we managed to escape and made home safe (ourselves and car).",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Suren Pillai",
      date: "November 2025",
      quote:
        "One of the best towing service in Thailand. The owner is a very helpful person. Helped us thru the flood without expecting anything in return.",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Jenn Yeu",
      date: "November 2025",
      quote:
        "å€¼å¾—æ¨èçš„ä¿é™©å…¬å¸ï¼Œéª‘è¡Œå»æ³°å›½æ¸¸ç©ä¹°ä¿é™©å€¼å¾—æ¨èçš„ä¸€å®¶ï¼Œå®¢æœäº”æ˜Ÿâ­â­â­â­â­ï¼Œwhatappå¯ä»¥ä»¥æµåˆ©çš„ä¸­æ–‡æ²Ÿé€šï¼ŒæœåŠ¡åˆ°ä½ï¼Œä¿¡æ¯å¯ä»¥è¯´æ˜¯åŠæ—¶å›å¤ï¼Œå¯ä»¥å®‰å¿ƒï¼Œæ²Ÿé€šå†…å®¹çš„è§£é‡Šä¹Ÿè¯¦ç»†ç†è§£ğŸ‘ğŸ‘ğŸ‘",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Ling Chia",
      date: "October 2025",
      quote:
        "åŠäº‹æ•ˆç‡é«˜ã€æ²Ÿé€šæ„‰å¿«ã€å“åº”è¿…é€Ÿã€æ¡æ¬¾è§£é‡Šæ¸…æ™°â€¦â€¦å¥½æœåŠ¡å€¼å¾—åˆ†äº«ï¼Œè€Œæœ€å¥½çš„æœåŠ¡æ°¸è¿œåœ¨è·¯ä¸ŠåŠ æ²¹ã€‚",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Simpson Poh",
      date: "October 2025",
      quote:
        "ç»è¿‡æœ‹å‹çš„ä»‹ç»è”ç»œåˆ°Johnï¼Œé©¾è½¦é©¾æ‘©æ‰˜è¿›æ³°å›½çš„éƒ½å¯ä»¥è¯¢é—®ä»–å…³äºä¿é™©ã€‚ä¸“ä¸šï¼Œäººä¹Ÿå¾ˆå¥½èŠã€‚æ„Ÿè°¢",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Alvin Tan",
      date: "October 2025",
      quote: "å»æ³°å›½ æ‰¾tms bike towing è°¢è°¢è€æ¿ å¸®æˆ‘æå®šå…¨éƒ¨",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Stephen Tee",
      date: "October 2025",
      quote:
        "æˆ‘æœ€è¿‘é€è¿‡ TMS Bike Towing è´­ä¹°æ³°å›½æ‘©æ‰˜è½¦ä¿é™©ï¼Œå¯¹ä»–ä»¬çš„ä¸“ä¸šæ€åº¦ä¸æœåŠ¡è´¨é‡æ„Ÿåˆ°éå¸¸æ»¡æ„ã€‚æ•´ä¸ªè¿‡ç¨‹é¡ºç•…ã€èµ„è®¯æ¸…æ™°ï¼Œè®©æˆ‘åœ¨è·¨å¢ƒéª‘è¡Œå‰æ›´åŠ å®‰å¿ƒä¸æœ‰ä¿¡å¿ƒã€‚ä»¥å¾€æˆ‘åœ¨è´­ä¹°æ³°å›½ä¿é™©æ—¶å‡ ä¹æ˜¯ä¸€çŸ¥åŠè§£ï¼Œåªæ˜¯éšä¾¿ä¹°äº†å°±ä¸Šè·¯ã€‚ç›´åˆ°è¿™æ¬¡ç»ç”± TMS Bike Towing çš„è®²è§£ï¼Œæˆ‘æ‰çœŸæ­£æ˜ç™½ä¿é™©çš„é‡è¦æ€§ã€‚ä»–ä»¬è¯¦ç»†è¯´æ˜äº†ä¿éšœèŒƒå›´ã€ç†èµ”æµç¨‹ä»¥åŠåœ¨æ³°å›½éª‘è¡Œå¯èƒ½é¢ä¸´çš„é£é™©ï¼Œè®©æˆ‘æ·±åˆ»ä½“ä¼šåˆ°å‡ºå›½éª‘è½¦ä¸€å®šè¦æœ‰å®Œå–„ä¿é™©ä¿éšœçš„é‡è¦æ€§ã€‚ç‰¹åˆ«æ„Ÿè°¢ååŠ©æˆ‘çš„é‚£ä½è´Ÿè´£äººï¼Œä»–ä¸ºäººè°¦é€Šã€æ€åº¦å‹å–„ã€è®²è§£æ¸…æ¥šï¼Œè®©æ•´ä¸ªè´­ä¹°è¿‡ç¨‹è½»æ¾åˆæ”¾å¿ƒã€‚",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Steven Lau",
      date: "October 2025",
      quote:
        "é€Ÿåº¦å¿«ï¼ŒæœåŠ¡å¥½ï¼Œäººå‹å–„ï¼Œè®²è§£ç»†ï¼Œæ²¡å¾—æŒ‘ã€‚ Kecekapan tinggi, sikap mesra, perkhidmatan yang sangat memuaskan, sangat disyorkanã€‚High efficiency, friendly attitude, very satisfactory service, highly recommendedã€‚à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸ªà¸¹à¸‡ à¸—à¸±à¸¨à¸™à¸„à¸•à¸´à¸—à¸µà¹ˆà¹€à¸›à¹‡à¸™à¸¡à¸´à¸•à¸£ à¸šà¸£à¸´à¸à¸²à¸£à¸™à¹ˆà¸²à¸à¸­à¹ƒà¸ˆà¸¡à¸²à¸ à¹à¸™à¸°à¸™à¸³à¹€à¸›à¹‡à¸™à¸­à¸¢à¹ˆà¸²à¸‡à¸¢à¸´à¹ˆà¸‡ã€‚",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Devis Lee",
      date: "October 2025",
      quote: "Service good, fast respond, cheaper price, recommend ğŸ‘ğŸ‘ğŸ‘",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Richard Cheong",
      date: "October 2025",
      quote: "The service is professional and very efficient",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Max Ng",
      date: "October 2025",
      quote: "äº”ä¸ªå­—,åšåˆ°åšå€’ä½ ğŸ‘ğŸ‘ğŸ‘",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Helo Ng",
      date: "October 2025",
      quote: "åœ¨æ³°åœ‹tms bike towingä¸€æµçš„æœå‹™",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Mei Peng",
      date: "August 2025",
      quote: "Good customer service, Fast and efficient ğŸ‘",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Venus Goh",
      date: "April 2025",
      quote:
        "è€æ¿æœåŠ¡è¶…çº§ä¸€æµï¼Œå‘ç”Ÿäº›å°æ„å¤–è¿›äº†åŒ»é™¢åœ¨ä¸€ä¸ªå°æ—¶çš„è·¯ç¨‹æ¥åŒ»é™¢æ¥æˆ‘å›é…’åº—ï¼ˆä¹Ÿè¦ä¸€ä¸ªå°æ—¶å·¦å³æ‰å›åˆ°é…’åº—ï¼‰ï¼Œé‚£æœ‰ä¸€å®¶ä¿é™©å…¬å¸æœ‰è¿™æ ·çš„æœåŠ¡ã€‚ğŸ‘ğŸ‘ğŸ‘ğŸ‘ ä½†æ˜¯ä¹°äº†ä¿é™©æ˜¯ä¿éšœï¼ˆçœŸçš„ä¸è¦æœ‰æœºä¼šç”¨å“¦ğŸ˜‡ï¼‰",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Alex Leong Wen Xin",
      date: "April 2025",
      quote:
        "Good customer service, prompt responses. Provides car/bike insurance services for MY-TH crossing, hassle free when crossing border. ğŸ‘ğŸ‘",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Eddie Pay",
      date: "February 2025",
      quote: "è€æ¿å¾ˆç”¨å¿ƒäº†è§£é¡¾å®¢ä»¬éœ€æ±‚ï¼Œä¼šä¸€ç›´ Update æƒ…å†µ",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "C Ho Tack",
      date: "February 2025",
      quote:
        "John provides good service to his customers. From my own experience, he personally came to attend towing services to my friends from Pattani to Hatyai and arranged transport for them too.",
      image: "/images/reviews/fb-placeholder.svg",
    },
    {
      name: "Justin Leong",
      date: "January 2025",
      quote:
        "This Towing Company such amazing services, they not only cover whole Thailand, also Malaysia & Singapore. How big of you!",
      image: "/images/reviews/fb-placeholder.svg",
    },
  ];

  // Chunk testimonials into columns for masonry effect
  function chunkIntoColumns<T>(array: T[], numColumns: number): T[][] {
    const columns: T[][] = Array.from({ length: numColumns }, () => []);
    array.forEach((item, index) => {
      columns[index % numColumns].push(item);
    });
    return columns;
  }

  $: desktopColumns = chunkIntoColumns(testimonials, 3);
  $: tabletColumns = chunkIntoColumns(testimonials, 2);
</script>

<section class="py-20">
  <div class="max-w-6xl mx-auto px-4 lg:px-8">
    <!-- Header -->
    <div class="text-center mb-12 reveal">
      <p
        class="text-primary font-semibold uppercase tracking-wider text-sm mb-3"
      >
        Reviews
      </p>
      <h2
        class="text-3xl lg:text-4xl font-bold text-text-main tracking-tight"
        style="letter-spacing: -0.02em;"
      >
        {title}
      </h2>
    </div>

    <!-- Desktop Grid (3 columns) -->
    <div class="hidden lg:grid lg:grid-cols-3 gap-4">
      {#each desktopColumns as column}
        <div class="space-y-4">
          {#each column as testimonial}
            <article class="card-3d-glass p-6">
              <!-- Author -->
              <div class="flex items-center gap-3 mb-4">
                <img
                  src={testimonial.image}
                  alt={testimonial.name}
                  class="w-10 h-10 rounded-full object-cover bg-gray-100"
                  loading="lazy"
                />
                <div>
                  <div class="font-semibold text-text-main">
                    {testimonial.name}
                  </div>
                  <div
                    class="flex items-center gap-1.5 text-xs text-text-secondary"
                  >
                    <svg
                      class="w-3.5 h-3.5 text-[#1877F2]"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path
                        d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
                      />
                    </svg>
                    <span>Recommends</span>
                    <span class="text-gray-300">Â·</span>
                    <span>{testimonial.date}</span>
                  </div>
                </div>
              </div>

              <!-- Quote -->
              <blockquote class="text-text-secondary leading-relaxed">
                {testimonial.quote}
              </blockquote>
            </article>
          {/each}
        </div>
      {/each}
    </div>

    <!-- Tablet Grid (2 columns) -->
    <div class="hidden md:grid md:grid-cols-2 lg:hidden gap-4">
      {#each tabletColumns as column}
        <div class="space-y-4">
          {#each column as testimonial}
            <article class="card-3d-glass p-6">
              <!-- Author -->
              <div class="flex items-center gap-3 mb-4">
                <img
                  src={testimonial.image}
                  alt={testimonial.name}
                  class="w-10 h-10 rounded-full object-cover bg-gray-100"
                  loading="lazy"
                />
                <div>
                  <div class="font-semibold text-text-main">
                    {testimonial.name}
                  </div>
                  <div
                    class="flex items-center gap-1.5 text-xs text-text-secondary"
                  >
                    <svg
                      class="w-3.5 h-3.5 text-[#1877F2]"
                      viewBox="0 0 24 24"
                      fill="currentColor"
                    >
                      <path
                        d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
                      />
                    </svg>
                    <span>Recommends</span>
                    <span class="text-gray-300">Â·</span>
                    <span>{testimonial.date}</span>
                  </div>
                </div>
              </div>

              <!-- Quote -->
              <blockquote class="text-text-secondary leading-relaxed">
                {testimonial.quote}
              </blockquote>
            </article>
          {/each}
        </div>
      {/each}
    </div>

    <!-- Mobile Horizontal Scroll -->
    <div
      class="md:hidden flex gap-4 overflow-x-auto scroll-snap-x pb-4 -mx-4 px-4"
      role="region"
      aria-label="Customer reviews"
    >
      {#each testimonials as testimonial}
        <article
          class="flex-shrink-0 w-[280px] card-3d-glass p-6 scroll-snap-start"
        >
          <!-- Author -->
          <div class="flex items-center gap-3 mb-4">
            <img
              src={testimonial.image}
              alt={testimonial.name}
              class="w-10 h-10 rounded-full object-cover bg-gray-100"
              loading="lazy"
            />
            <div>
              <div class="font-semibold text-text-main text-sm">
                {testimonial.name}
              </div>
              <div
                class="flex items-center gap-1.5 text-xs text-text-secondary"
              >
                <svg
                  class="w-3.5 h-3.5 text-[#1877F2]"
                  viewBox="0 0 24 24"
                  fill="currentColor"
                >
                  <path
                    d="M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3"
                  />
                </svg>
                <span>Recommends</span>
              </div>
            </div>
          </div>

          <!-- Quote -->
          <blockquote class="text-text-secondary text-sm leading-relaxed">
            {testimonial.quote}
          </blockquote>

          <div class="text-xs text-gray-400 mt-3">{testimonial.date}</div>
        </article>
      {/each}
    </div>

    <!-- Facebook Link -->
    <div class="text-center mt-12 reveal">
      <a
        href="https://www.facebook.com/profile.php?id=61560761347672"
        target="_blank"
        rel="noopener noreferrer"
        class="inline-flex items-center gap-3 text-sm text-text-secondary hover:text-primary transition-colors duration-300 font-medium"
      >
        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
          <path
            d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"
          />
        </svg>
        See all reviews on Facebook
        <svg
          class="w-4 h-4"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="1.5"
            d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"
          />
        </svg>
      </a>
    </div>
  </div>
</section>

<style>
  /* Mobile horizontal scroll */
  .scroll-snap-x {
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    scrollbar-width: none;
  }

  .scroll-snap-x::-webkit-scrollbar {
    display: none;
  }

  .scroll-snap-start {
    scroll-snap-align: start;
  }

  /* Card shadow */
  .card-shadow {
    box-shadow:
      0 1px 3px rgba(0, 0, 0, 0.04),
      0 4px 12px rgba(0, 0, 0, 0.03);
  }

  /* Respect reduced motion */
  @media (prefers-reduced-motion: reduce) {
    .scroll-snap-x {
      scroll-snap-type: none;
    }
  }
</style>
